using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace SQL_LINQ_SAMPLE
{
    class Program
    {
        static void Main(string[] args)
        {
            int[] idArray = { 164162000, 164162100, 164162200, 164367900, 164368000, 164368100, 164368300, 164368400, 164368500, 164368700, 164368800, 164368900, 164369100, 164369200, 164369300, 164369500, 164369600, 164369700, 164369900, 164370200, 164370700, 164371000, 164371100, 164371200, 164371400, 164371500, 164371600, 164371700, 165547100, 165548900, 165846700, 165846800, 165846900, 165860400, 165860500, 165860600, 165860800, 165862300, 165862400, 165862500, 165862600, 165862700, 165862800, 165862900, 165863000, 165863100, 165863200, 165863300, 165863400, 165863500, 165863600, 165863700, 165863800, 165863900, 165864000, 165864100, 165864200, 165864300, 165864400, 165864500, 165864600, 165864700, 165864800, 165864900, 165865000, 165865100, 165865200, 165865300, 165865400, 165865500, 165865600, 165865700, 165865900, 165866000, 165866100, 165866200, 165866300, 165866400, 165866500, 165866600, 165866700, 165866800, 165866900, 165867000, 165867100, 165867200, 165867300, 165867500, 165867600, 165867700, 165867800, 165867900, 165868000, 165868100, 165868200, 165868400, 165868500, 165868600, 165868700, 165868800, 165868900, 165869000, 165869100, 165869200, 165869400, 165869500, 165869600, 165877300, 165880800, 165881600, 165881700, 165881800, 165882000, 165882200, 165888600, 165888800, 167373300, 167373400, 167373500, 167373600, 167373700, 167373800, 167373900, 167851600, 167851700, 167851800, 167853700, 167853800, 167853900, 167854800, 167854900, 167855000, 167882400, 167882500, 167882600, 167882800, 167882900, 167883000, 167947500, 167947600, 167947700, 167947800, 167948200, 167948300, 167948400, 167948500, 167948600, 167948700, 167948800, 167948900, 167949000, 167949100, 167949200, 167949300, 167949400, 167949500, 168233400, 168233900, 168234000, 168234100, 168234300, 168234400, 168234500, 168234900, 168235000, 168235100, 168235400, 168235600, 168235700, 168235800, 168236200, 168236300, 168236400, 168236600, 168236700, 168236800, 179191400, 186332100, 187381400, 187381500, 242143000, 242144600, 242144800, 242145000, 245836600, 246534900, 246535400, 248259400, 248260200, 251814200, 251814300, 251814400, 251814700, 251814800, 251814900, 255560500, 255560700, 255560800, 255560900, 255561000, 255561100, 255561200, 255906500, 255906600, 255906700, 255906800, 255906900, 255907000, 256027800, 256027900, 256028000, 256028100, 256028200, 256028500, 256028600, 256411000, 256411300, 256411400, 256411600, 256412200, 256412400, 256412700, 256412900, 256413100, 256413300, 256413500, 256413600, 256413900, 256414100, 256414400, 256414500, 256414800, 256415000, 256415100, 256415400, 256415600, 256415800, 256415900, 277440600, 277440700, 277440800, 288937700, 288942500, 289200200, 289201500, 289212800, 289220400, 289432000, 289435700, 289436600, 289440200, 289441200, 289447200, 289447900, 289551300, 289552600, 289552700, 289552800, 289554100, 289555200, 289556700, 289560100, 289729600, 289730300, 289730400, 289730500, 289735400, 289735900, 289736600, 289736700, 289736800, 289737500, 289737900, 289738300, 289739000, 289739700, 289739800, 289739900, 289740600, 289740700, 289740800, 289741500, 289741900, 289742300, 289742600, 289742700, 289743400, 289743500, 289743600, 289744300, 289744700, 289746000, 289746700, 289746800, 289747500, 289748200, 289748300, 289749000, 289749700, 289750400, 289750500, 289750800, 289750900, 289751600, 289751700, 290866500, 290866600, 290866700, 290866800, 290866900, 290867100, 290867200, 290867300, 290867400, 290867500, 290867700, 290867900, 290868100, 290868200, 290868300 };
            List<int> ids = new List<int>(idArray);
            using (var x = new myDbDataContext())
            {
                var rows = from product in x.DigitalRiverProducts
                            where ids.Contains(product.DigitalRiverID)
                           from pr in x.Prices
                           where (product.SKUID == pr.SKUID)
                           select product;
                foreach (var row in rows)
                {
                    Console.WriteLine(row.SKUID);
                }
            }
            Console.ReadLine();
        }
    }
}
